<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../css/dashboard.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <style>
      .container-custom {
        display: flex;
        flex-direction: column;
        margin-left: 20px;
        margin-right: 20px;
        .visualizacao {
          width: 100%;
        }
        .linha {
          align-self: center;
        }
      }

      .col-nav {
        display: flex;
        width: 46.14px;
        height: 61.88px;
        padding-right: 15px;
        padding-left: 0px;
      }

      .col {
        display: flex;
        width: 100%;
        height: 100%;
        margin-right: 15px;
        padding-left: 0px;
        border-radius: 8px;
      }

      .col-nav:last-child {
        padding-right: 0px;
      }

      .col:last-child {
        margin-right: 0px;
      }

      body {
        width: 100%;
      }
    </style>
  </head>

  <body>
    <header class="header py-4 bg-light px-0">
      <div class="container d-flex justify-content-between align-items-center">
        <a href="">
          <img
            src="./assets/botao-voltar 4.svg"
            alt="botao-voltar"
            class="mx-3"
            onclick="window.history.back()"
        /></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
            <img
            src="./assets/burger-bar 1 (1).svg"
            alt="menu-lateral"
            class="navbar-toggler-icon mx-3"/>
        </button>
        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel" style="background-color: #012171; color: white; border-radius: 1rem 0rem 0rem 1rem; width: 65%;">
          <div class="offcanvas-body">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3 gap-4" style="font-size: larger; margin-left: 2rem; margin-top: 6rem;">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Pedidos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Contatos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="fichas/Lista_fichas.html">Fichas</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Lista-peca.html">Produtos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Lista-tecido.html">Tecidos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="dashboard.html">Monitoramento</a>
              </li>
          </div>
        </div>
      </div>
    </header>

    <div class="container-custom mt-4">
      <div class="visualizacao">
        <span> Deseja ver os dados em que período? </span>
        <select name="" id="">
          <option value="">Último 30 dias</option>
          <option value="">Últimos 7 dias</option>
          <option value="">Últimas 24 horas</option>
        </select>
      </div>
      <div class="linha kpis">
        <div class="col">
          <div class="kpi-box-icon">
            <div class="kpi-container-icon">
              <?xml version="1.0" ?>

              <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
              <svg
                width="800px"
                height="800px"
                viewBox="0 0 512 512"
                version="1.1"
                xml:space="preserve"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
              >
                <style type="text/css">
                  .st0 {
                    fill: #012171;
                  }
                  .st1 {
                    fill: none;
                    stroke: #012171;
                    stroke-width: 32;
                    stroke-linecap: round;
                    stroke-linejoin: round;
                    stroke-miterlimit: 10;
                  }
                </style>

                <g id="Layer_1" />

                <g id="Layer_2">
                  <g>
                    <g>
                      <path
                        class="st0"
                        d="M234.37,260.84l-46.26,21.06c-26.63,12.11-43.71,38.66-43.71,67.91v24.52h223.22V349.8     c0-29.25-17.09-55.79-43.71-67.91l-46.26-21.06c-4.15-1.89-4.15-7.79,0-9.68l46.26-21.06c26.63-12.11,43.71-38.66,43.71-67.91     v-24.52H144.39v24.52c0,29.25,17.09,55.79,43.71,67.91l46.26,21.06C238.52,253.05,238.52,258.95,234.37,260.84z"
                      />
                    </g>

                    <g>
                      <path
                        class="st0"
                        d="M386.67,407.44H125.33c-16.86,0-30.53,13.67-30.53,30.53l0,0c0,16.86,13.67,30.53,30.53,30.53h261.33     c16.86,0,30.53-13.67,30.53-30.53l0,0C417.19,421.11,403.52,407.44,386.67,407.44z"
                      />
                    </g>

                    <g>
                      <path
                        class="st0"
                        d="M386.67,43.5H125.33c-16.86,0-30.53,13.67-30.53,30.53l0,0c0,16.86,13.67,30.53,30.53,30.53h261.33     c16.86,0,30.53-13.67,30.53-30.53l0,0C417.19,57.17,403.52,43.5,386.67,43.5z"
                      />
                    </g>
                  </g>
                </g>
              </svg>
            </div>
          </div>
          <div class="kpi-box-info">
            <div class="kpi-container-info-label">
              <span>PEDIDOS</span>
            </div>
            <div class="kpi-container-info-numbers">
              <div class="kpi-container-info-principal-number">
                <span id="kpi-pedido-numero"> 0 </span>
              </div>
              <div class="kpi-container-info-secondary-number">
                <div id="container-seta-pedido">
                  <?xml version="1.0" ?><svg
                    viewBox="0 0 32 32"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <title />
                    <g data-name="Layer 2" id="Layer_2">
                      <path
                        d="M9.05,10.05a1,1,0,0,0,1.42,0l4.6-4.6V29a1,1,0,0,0,2,0V5.48l4.57,4.57a1,1,0,0,0,1.41-1.41L16.69,2.27a.9.9,0,0,0-1.27,0L9.05,8.64A1,1,0,0,0,9.05,10.05Z"
                      />
                    </g>
                  </svg>
                </div>

                <span id="kpi-pedido-porcentagem"> 0% </span>
              </div>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="kpi-box-icon">
            <div class="kpi-container-icon">
              <?xml version="1.0" ?>
              <svg
                height="100%"
                style="
                  fill-rule: evenodd;
                  clip-rule: evenodd;
                  stroke-linejoin: round;
                  stroke-miterlimit: 2;
                "
                version="1.1"
                viewBox="0 0 32 32"
                width="100%"
                xml:space="preserve"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:serif="http://www.serif.com/"
                xmlns:xlink="http://www.w3.org/1999/xlink"
              >
                <path
                  d="M4.554,23.764c-0.111,0.322 -0.049,0.679 0.163,0.946c2.544,3.201 6.645,5.29 11.273,5.29c4.628,0 8.729,-2.089 11.273,-5.29c0.212,-0.267 0.273,-0.624 0.163,-0.946c-1.538,-4.485 -6.07,-7.764 -11.436,-7.764c-5.366,0 -9.898,3.279 -11.436,7.764Z"
                />
                <circle cx="15.99" cy="8" r="6" />
              </svg>
            </div>
          </div>
          <div class="kpi-box-info">
            <div class="kpi-container-info-label">
              <span>CLIENTES</span>
            </div>
            <div class="kpi-container-info-numbers">
              <div class="kpi-container-info-principal-number">
                <span id="kpi-cliente-numero"> 0 </span>
              </div>
              <div class="kpi-container-info-secondary-number">
                <div id="container-seta-cliente">
                  <?xml version="1.0" ?><svg
                    viewBox="0 0 32 32"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <title />
                    <g data-name="Layer 2" id="Layer_2">
                      <path
                        d="M23.05,22a1,1,0,0,0-1.41,0L17,26.56V3a1,1,0,1,0-2,0V26.53L10.47,22a1,1,0,0,0-1.42,0,1,1,0,0,0,0,1.41l6.37,6.37a.9.9,0,0,0,1.27,0l6.36-6.37A1,1,0,0,0,23.05,22Z"
                      />
                    </g>
                  </svg>
                </div>
                <span id="kpi-cliente-porcentagem"> 0% </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="linha grafico">
        <div class="col">
          <div class="grafico-boxes">
            <div class="grafico-container-grafico">
              <canvas id="grafico-pedido"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="linha grafico">
        <div class="col">
          <div class="grafico-boxes">
            <div class="grafico-container-grafico">
              <canvas id="grafico-tecido"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="./js/graph.js"></script>
<script src="./js/kpi.js"></script>
<script>
  function redirecionar() {
    window.location = "Lista-peca.html";
  }

  window.onload = async function () {
    buscarRelatorioPedido(1);
    buscarRelatorioCliente(1);
    var dadosPedido = await buscarViewPedido(1);
    var labelsPedido = adicionarLabelsPedido(dadosPedido);
    var dataPedido = adicionarDadosPedido(dadosPedido);

    var dadosTecido = await buscarViewTecido(1);
    var labelsTecido = adicionarLabelsTecido(dadosTecido);
    var dataTecido = adicionarDadosTecido(dadosTecido);

    const datasetsPedido = {
      labels: labelsPedido,
      datasets: [
        {
          label: "Pedidos",
          data: dataPedido,
          borderColor: "rgba(0, 3, 199, 0.5)",
          backgroundColor: "rgba(0, 3, 199, 0.5)",
          yAxisID: "y",
        },
      ],
    };

    const configPedido = {
      type: "bar",
      data: datasetsPedido,
      options: {
        responsive: true,
        interaction: {
          mode: "index",
          intersect: false,
        },
        stacked: false,
        plugins: {
          title: {
            display: true,
            text: "Quais são os três clientes com mais pedidos este semestre?",
          },
        },
        scales: {
          y: {
            type: "linear",
            display: true,
            position: "left",
          },
          y1: {
            type: "linear",
            display: true,
            position: "right",
            grid: {
              drawOnChartArea: false,
            },
          },
        },
      },
    };

    const datasetsTecido = {
      labels: labelsTecido,
      datasets: [
        {
          label: "Tecidos",
          data: dataTecido,
          borderColor: "rgba(0, 3, 199, 0.5)",
          backgroundColor: "rgba(0, 3, 199, 0.5)",
          yAxisID: "y",
        },
      ],
    };

    const configTecido = {
      type: "bar",
      data: datasetsTecido,
      options: {
        responsive: true,
        interaction: {
          mode: "index",
          intersect: false,
        },
        stacked: false,
        plugins: {
          title: {
            display: true,
            text: "Quais são os três tecidos com mais frequência este semestre?",
          },
        },
        scales: {
          y: {
            type: "linear",
            display: true,
            position: "left",
          },
          y1: {
            type: "linear",
            display: true,
            position: "right",
            grid: {
              drawOnChartArea: false,
            },
          },
        },
      },
    };

    const graficoPedido = document
      .getElementById("grafico-pedido")
      .getContext("2d");
    const graficoTecido = document
      .getElementById("grafico-tecido")
      .getContext("2d");
    new Chart(graficoPedido, configPedido);
    new Chart(graficoTecido, configTecido);
  };
</script>
